<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>Cari Pegawai</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css">
	<script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
	<script src="/js/pegawaidatatable.js"></script>
	<object th:include="fragments/fragment :: css" th:remove="tag"></object>
	<object th:include="fragments/fragment :: js" th:remove="tag"></object>
	
</head>
<body>
	<nav th:replace="fragments/fragment :: navbar"></nav>
	<br>
	<div class="container-fluid">
        <div class="row">
        	<div class="card">
              <div class="card-header">
                 	Tambah Pegawai
              </div>
              <div class="card-body">
              	<form th:action="@{/pegawai/cari}" method="GET">
				    <div class="form-group">
					    <label for="location">Provinsi:</label>
					    <select  class="form-control" required="required" name="idProvinsi" id="provinsi">
					      <option disabled="disabled" selected="selected" > -- Pilih Provinsi -- </option>
					      <option th:each="provinsi : ${listProvinsi}" th:value="${provinsi.id}" 
					      th:text="${provinsi.nama}"></option>
					    </select>
					</div>
					<div class="form-group">
				       <label for="location">Instansi:</label>
				       <select class="form-control" name="idInstansi" id="instansi" required="required">
				       			 <option disabled="disabled" selected="selected" > -- Pilih Instansi -- </option>
				           
				       </select>
					</div>
					  
					<div class="form-group">
				       <label for="location">Jabatan:</label>
				       <select class="form-control" name="idJabatan" id="idJabatan" required="required">
				       		<option disabled="disabled" selected="selected" > -- Pilih Jabatan -- </option>
				           	<option th:each="jabatan : ${listJabatan}" th:value="${jabatan.id}" 
					      th:text="${jabatan.nama}"></option>	
				       </select>
					</div>
					
					<button type="submit"> Cari</button>
				</form>
              
              </div>
            </div>
        </div>
        <br>
       	<table id="pegawaiTable" class="display">
	       <thead>
	            <tr>
					<th>NIP</th>
	                <th>Nama</th>
	                <th>Tempat Lahir</th>
	                <th>Tanggal Lahir</th>
	                <th>Tahun Masuk</th>
	                <th>Instansi</th>
	                <th>Jabatan</th>
	            </tr>
	        </thead>
	    </table>
    </div>	
</body>
<script th:inline="javascript">
$('#provinsi').change(
        function() {
        	console.log("ayam")
            $.getJSON("/pegawai/instansi", {
                idProvinsi : $(this).val(),
                ajax : 'true'
            }, function(data) {
            	console.log("ayam betutu");
            	var html = '<option value="">--Pilih Instansi--</option>';
                var len = data.length;
                for ( var i = 0; i < len; i++) {
                    html += '<option value="' + data[i].id + '">'
                            + data[i].nama + '</option>';
                }
                html += '</option>';
                $('#instansi').html(html);
            });
        	console.log("papaprapap");
        });
</script>
</html>